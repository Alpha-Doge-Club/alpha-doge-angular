<!-- start of layout header -->
<div class="margin-from-header"></div>
<div class="layout">
  <div>
    <div class="card_container">
      <div class="card">
        <div class="text">Trading Volume</div>
        <div class="title">$123,456,789</div>
        <div class="text">Last 24h</div>
      </div>
      
      <div class="card">
        <div class="text">Trades</div>
        <div class="title">123,456</div>
        <div class="text">Last 24h</div>
      </div>

      <div class="card">
        <div class="text">Average Leverage</div>
        <div class="title">14x</div>
        <div class="text">Last 24h</div>
      </div>
      
    </div>
    <div class="card_container">   
      <div class="card">
        <div class="text">Open Interest</div>
        <div class="title">$123,456,789</div>
        <div class="text">Last 24h</div>
      </div>

      <div class="card">
        <div class="text">P&L</div>
        <div class="title">$3,456,789 +</div>
        <div class="text">Last 24h</div>
      </div>

      <div class="card">
        <div class="text">New Wallet Connected</div>
        <div class="title">345,678</div>
        <div class="text">Last 24h</div>
      </div>
    </div>
  </div>
  <div>
    <div class="buttons">
      <div><button>View All</button></div>
      <div><button>Sort by AUM</button></div>
      <div><button>Sort by P&L</button></div>
      <div><button>Sort by ROI</button></div>
      <div><button>Sort by Leverage</button></div>
      <div><button>Open Only</button></div>
    </div>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Account</th>
          <th>AUM</th>
          <th>PL</th>
          <th>ROI</th>
          <th>SHARP</th>
          <th>LP</th>
          <th>Stat</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          
          <td>1</td>
          <td><a href="#">Blah Blah</a></td>
          <td><a href="#">$12,000,000</a></td>
          <td><a href="#">+$1,000,000</a></td>
          <td><a href="#">+30%</a></td>
          <td><a href="#">25%</a></td>
          <td><a href="#">1,234</a></td>
          <td><a href="#">Open</a></td>
        </tr>
        
        <tr>
          <td><a href="#">2</a></td>
          <td><a href="#">Jane Smith</a></td>
          <td><a href="#">$8,000,000</a></td>
          <td><a href="#">+$800,000</a></td>
          <td><a href="#">+20%</a></td>
          <td><a href="#">20%</a></td>
          <td><a href="#">567</a></td>
          <td><a href="#">Closed</a></td>
        </tr>
        
        <!-- Row 3 -->
        <tr>
          <td><a href="#">3</a></td>
          <td><a href="#">Mike Johnson</a></td>
          <td><a href="#">$5,000,000</a></td>
          <td><a href="#">+$500,000</a></td>
          <td><a href="#">+15%</a></td>
          <td><a href="#">15%</a></td>
          <td><a href="#">789</a></td>
          <td><a href="#">Open</a></td>
        </tr>
        
        <!-- Row 4 -->
        <tr>
          <td><a href="#">4</a></td>
          <td><a href="#">Sarah Lee</a></td>
          <td><a href="#">$3,000,000</a></td>
          <td><a href="#">+$300,000</a></td>
          <td><a href="#">+10%</a></td>
          <td><a href="#">10%</a></td>
          <td><a href="#">345</a></td>
          <td><a href="#">Closed</a></td>
        </tr>
        
        <!-- Row 5 -->
        <tr>
          <td><a href="#">5</a></td>
          <td><a href="#">Tommy Nguyen</a></td>
          <td><a href="#">$20,000,000</a></td>
          <td><a href="#">+$2,000,000</a></td>
          <td><a href="#">+50%</a></td>
          <td><a href="#">30%</a></td>
          <td><a href="#">2,345</a></td>
          <td><a href="#">Open</a></td>
        </tr>
      
      <tr>
        <td>2</td>
        <td><a href="#">Alice Smith</a></td>
        <td><a href="#">$5,000,000</a></td>
        <td><a href="#">+$400,000</a></td>
        <td><a href="#">+15%</a></td>
        <td><a href="#">18%</a></td>
        <td><a href="#">345</a></td>
        <td><a href="#">Open</a></td>
      </tr>
      <tr>
        <td>3</td>
        <td><a href="#">Bob Johnson</a></td>
        <td><a href="#">$3,500,000</a></td>
        <td><a href="#">+$300,000</a></td>
        <td><a href="#">+12%</a></td>
        <td><a href="#">17%</a></td>
        <td><a href="#">678</a></td>
        <td><a href="#">Closed</a></td>
      </tr>
      <tr>
        <td>4</td>
        <td><a href="#">Emily Davis</a></td>
        <td><a href="#">$8,700,000</a></td>
        <td><a href="#">+$900,000</a></td>
        <td><a href="#">+25%</a></td>
        <td><a href="#">22%</a></td>
        <td><a href="#">910</a></td>
        <td><a href="#">Open</a></td>
      </tr>
      <tr>
        <td>5</td>
        <td><a href="#">Michael Lee</a></td>
        <td><a href="#">$2,000,000</a></td>
        <td><a href="#">+$100,000</a></td>
        <td><a href="#">+5%</a></td>
        <td><a href="#">12%</a></td>
        <td><a href="#">111</a></td>
        <td><a href="#">Closed</a></td>
      </tr>
      <tr>
        <td>6</td>
        <td><a href="#">Sophia Chen</a></td>
        <td><a href="#">$6,800,000</a></td>
        <td><a href="#">+$700,000</a></td>
        <td><a href="#">+18%</a></td>
        <td><a href="#">20%</a></td>
        <td><a href="#">456</a></td>
        <td><a href="#">Open</a></td>
      </tr>
      <tr>
        <td>7</td>
        <td><a href="#">Alex Johnson</a></td>
        <td><a href="#">$1,500,000</a></td>
        <td><a href="#">+$50,000</a></td>
        <td><a href="#">+3%</a></td>
        <td><a href="#">10%</a></td>
        <td><a href="#">789</a></td>
        <td><a href="#">Closed</a></td>
      </tr>
      
      </tbody>
    </table>
    
    

    
  </div>

  <div>
    <div class="layout-header">
      <div>
        <div class="block-colored"></div>
        <h1 class="main-title">Get Cover / {{pool.name}} / {{policy.name}}</h1>
      </div>
      <div class="go-back-div">
        <a routerLink="/get-cover/{{pool.path}}"><img src="/assets/images/arrow-circle.svg" /></a>
        <h2 class="go-back">Back</h2>
      </div>
    </div>

    <div class="main-text-container main-text-container-1">
      <div class="text-template-1">
        <p class="template-1-header sub-title">Weekly Cost</p>
        <div class="available-amout-usdc">
          <div class="available-amount">{{formatRate(policy.weeklyPremium)}}</div>
          <div class="usdc">%</div>
        </div>
      </div>
      <div class="text-template-1">
        <p class="template-1-header sub-title">Collateral Amount</p>
        <div class="available-amout-usdc">
          <div class="available-amount">${{formatBalance(collateralAmount)}}</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- end of the layout header -->

<div class="purchase-form">
  <div class="get-cover-form-container">
    <div class="date-input-container">
      <div class="date-input-and-tag">
        <div class="date-label">
          <div>Start Date</div>
        </div>
        <input class="date-input" placeholder="MM / DD / YY" type="date"
            step="7" min="{{formatDate(startDateMin)}}"
            [(ngModel)]="startDate" (change)="onStartDateChange()"/>
      </div>
      <div class="date-input-and-tag">
        <div class="date-label">
          <div>End Date</div>
        </div>
        <input class="date-input" placeholder="MM / DD / YY" type="date"
            step="7" min="{{formatDate(endDateMin)}}"
            [(ngModel)]="endDate" (change)="onEndDateChange()"/>
      </div>
    </div>

    <div class="input-label">
      <div class="input-cover-amount-label">Cover Amount</div>
      <div class="max" (click)="max()">Max</div>
    </div>
    <input class="cover-amount-input" type="text" [(ngModel)]="amountToCover" [value]="amountToCover"/>
    <div class="available-capacity">
      <p class="available-capacity-text">Available Capacity
        <span class="icon-info" (click)="openAlert('capacity')"></span>
      </p>
      <p class="available-capacity-amount">{{ startDate && endDate ? formatBalance(capacityMin) : "--"}} {{pool.currencyName}}</p>
    </div>


    <div class="capacityContainer" (mouseleave)="capacityMouseIndex = -1">
      <ng-container *ngIf="!capacityLoading">
        <div *ngFor="let item of capacityArray; let i = index" class="capacityBox"
            [style.width]="chartBarSize"
              (mouseover)="capacityMouseIndex = i"
            >
          <div class="capacityBar"
              [style.height]="capacityToHeight(item.amount)"
              [style.backgroundColor]="isDateInRange(item.startTime, startDate, endDate) ? '#135CA5' : '#DCE3F2'"
              [style.zIndex]="isDateInRange(item.startTime, startDate, endDate) ? 1 : 0"></div>
          <span class="capacityBoxAmount"
              *ngIf="(i==capacityMaxIndex) && capacityMouseIndex == -1 || i==capacityMouseIndex">${{formatBalance(item.amount)}}
            <div class="capacityBoxAmountLine"></div>
          </span>
          <span class="capacityBoxStart"
              *ngIf="i == 0 && capacityMouseIndex == -1 || i == capacityMouseIndex">
            <div class="capacityDateLine"></div>{{formatDateSimple(item.startTime)}}
          </span>
          <span class="capacityBoxEnd"
              *ngIf="i == capacityArray.length - 1 && capacityMouseIndex == -1">
            <div class="capacityDateLine"></div>{{formatDateSimple(item.endTime)}}
          </span>
        </div>
        <div class="capacityLine" *ngIf="capacityMin && startDate && endDate"
            [style.bottom]="capacityToHeight(capacityMin)">
          <span class="capacityLine-amount">${{formatBalance(capacityMin)}}</span>
          <span class="capacityLine-text">available<br/>capacity</span>
        </div>
      </ng-container>
    </div>

    <div class="input-label margin-top">
      <div class="input-cover-amount-label input-margin-top">
        Additional Notes
      </div>
    </div>
    <input
      class="cover-amount-input"
      placeholder="Add your Notes"
      type="text"
      [(ngModel)]="notes"
      [value]="notes"
    />
    <div class="available-capacity">
      <p class="available-capacity-text">
        Text form, eg. Valitador 1131-1431
      </p>
    </div>
  </div>
  <div class="input-field-1">
    <div class="input-feild-header">
      <h1 class="summary">
        <span class="icon-credit-card"></span>
        Payment Summary</h1>
    </div>
    <div class="purchase-details-container">
      <div class="purchase-details">
        <div>Cover Amount</div>
        <div>{{formatBalance(getEstCover())}} {{pool.currencyName}}</div>
      </div>
      <div class="purchase-details">
        <div>Cover Duration</div>
        <div>{{getEstWeeks()}} Weeks</div>
      </div>
      <div class="purchase-details">
        <div>You Will Pay</div>
        <div>{{formatBalance(getEstPremium(), 2)}} {{pool.currencyName}}</div>
      </div>
    </div>

    <button class="form-deposit-button" *ngIf="allowance <= 1e18" [disabled]="approving" (click)="approve()">
      <span>Approve
        <span class="icon-spinner" *ngIf="approving"></span>
      </span>
    </button>
    <button class="form-deposit-button" *ngIf="allowance > 1e18" [disabled]="buying" (click)="buy()">
      <span>Purchase
        <span class="icon-spinner" *ngIf="buying"></span>
      </span>
    </button>
  </div>
</div>
<div class="terms-and-conditions">
  <h1 class="terms">Terms and Conditions</h1>
  <p class="terms-details">
    {{policy.terms}}
  </p>
</div>

<div class="margin-space"></div>

<app-alert-message
  [title]="alertTitle"
  [body]="alertBody"
  style="height: 100%; width: 100%; z-index: 1; position: Fixed; left: 0; top: 0;"
  *ngIf="willShowAlertMessage"
  (onClose)="closeAlert()">
</app-alert-message>
